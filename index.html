<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>YOPO AI PRO | Premium Crypto Analytics</title>

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>

  <!-- ✅ 분리된 CSS -->
  <link rel="stylesheet" href="./styles.css">
</head>

<body>
  <!-- AUTH OVERLAY -->
  <div class="auth-overlay" id="auth-overlay">
    <div class="auth-card">
      <h2 class="auth-title"><i class="fa-solid fa-lock"></i> YOPO AI PRO 잠금</h2>
      <p class="auth-sub">
        비밀번호를 입력해야 접속할 수 있습니다.<br/>
        (기본 비밀번호: <b>2580</b>)
      </p>
      <div class="auth-row">
        <input id="auth-input" type="password" placeholder="비밀번호 입력" />
        <button class="btn primary" onclick="tryAuth()">확인</button>
      </div>
      <div class="auth-hint">접속 후 새로고침해도 인증 유지됩니다.</div>
    </div>
  </div>

  <!-- APP -->
  <div id="app">
    <!-- LEFT -->
    <div class="left">
      <header class="topbar">
        <div class="brand">
          <div class="logo">YOPO</div>
          <div class="brand-txt">
            <h1>YOPO AI PRO</h1>
            <p>Premium Crypto Analytics</p>
          </div>
        </div>

        <div class="top-actions">
          <div class="pill" id="btc-dom-pill">BTC DOM: --</div>
          <div class="pill muted" id="tf-pill">TF: 1H</div>
        </div>
      </header>

      <section class="panel">
        <div class="panel-head">
          <h3><i class="fa-solid fa-magnifying-glass-chart"></i> 분석 & 스캔</h3>
          <div class="panel-actions">
            <button class="btn" onclick="setTF('60')">단기(1H)</button>
            <button class="btn" onclick="setTF('240')">중기(4H)</button>
            <button class="btn" onclick="setTF('D')">장기(1D)</button>
          </div>
        </div>

        <div class="grid2">
          <button class="btn primary" onclick="executeAnalysisAll()">
            <i class="fa-solid fa-wand-magic-sparkles"></i> 통합 예측(단·중·장)
          </button>
          <button class="btn" onclick="autoScanUniverseAll()">
            <i class="fa-solid fa-robot"></i> 자동 스캔(단·중·장)
          </button>
        </div>

        <div class="grid2">
          <button class="btn" onclick="runBacktest()">
            <i class="fa-solid fa-chart-simple"></i> 백테스트
          </button>
          <button class="btn danger" onclick="cancelOngoingOperations()">
            <i class="fa-solid fa-ban"></i> 진행 취소
          </button>
        </div>

        <div class="grid2">
          <button class="btn" onclick="resetStatsUIAndData()">
            <i class="fa-solid fa-rotate-left"></i> 누적 리셋
          </button>
          <button class="btn" onclick="cancelAllTracking()">
            <i class="fa-solid fa-xmark"></i> 추적 전체 취소
          </button>
        </div>

        <div class="grid2">
          <button class="btn danger" onclick="resetAll()">
            <i class="fa-solid fa-trash"></i> 전체 초기화(누적+추적+취소)
          </button>
          <button class="btn" onclick="confirmTrack()">
            <i class="fa-solid fa-location-crosshairs"></i> 선택 추적 등록
          </button>
        </div>

        <div class="hint-row">
          <div id="scan-status">대기중...</div>
          <div id="rec-container"></div>
        </div>
      </section>

      <section class="panel">
        <div class="panel-head">
          <h3><i class="fa-solid fa-coins"></i> 마켓</h3>
        </div>

        <div class="market-list">
          <div class="section-title">
            <span>유망 코인 60 (자동+AI 추천)</span>
            <span class="right">
              <span class="status-dot" id="api-dot"></span>
              <span id="universe-ts">업데이트: --</span>
            </span>
          </div>
          <div id="market-list-container"></div>
        </div>
      </section>
    </div>

    <!-- RIGHT -->
    <div class="right">
      <section class="panel">
        <div class="panel-head">
          <h3><i class="fa-solid fa-chart-line"></i> 차트</h3>
          <div class="panel-actions">
            <button class="btn" onclick="executeAnalysisAll()">예측</button>
            <button class="btn" onclick="quickAnalyzeAndShow(state.symbol, state.tfRaw)">빠른분석</button>
          </div>
        </div>
        <div id="chart-wrap"></div>
      </section>

      <section class="panel">
        <div class="panel-head">
          <h3><i class="fa-solid fa-bullseye"></i> 정밀 추적</h3>
        </div>
        <div class="stats-grid">
          <div class="stat">
            <div class="label">누적 성공</div>
            <div class="value" id="win-stat">0</div>
          </div>
          <div class="stat">
            <div class="label">총 예측</div>
            <div class="value" id="total-stat">0</div>
          </div>
          <div class="stat">
            <div class="label">추적중</div>
            <div class="value" id="active-stat">0</div>
          </div>
        </div>

        <div id="tracking-container"></div>
      </section>

      <section class="panel">
        <div class="panel-head">
          <h3><i class="fa-solid fa-clock-rotate-left"></i> 종료 기록</h3>
          <div class="panel-actions">
            <span class="pill muted">총 <b id="history-count">0</b>건</span>
          </div>
        </div>
        <div id="history-container"></div>
      </section>

      <section class="panel" id="bt-box">
        <div class="panel-head">
          <h3><i class="fa-solid fa-flask"></i> 백테스트</h3>
        </div>
        <div class="bt-grid">
          <div class="bt-item">
            <div class="label">샘플</div>
            <div class="value" id="bt-n">-</div>
          </div>
          <div class="bt-item">
            <div class="label">승률</div>
            <div class="value" id="bt-win">-</div>
          </div>
          <div class="bt-item">
            <div class="label">평균</div>
            <div class="value" id="bt-avg">-</div>
          </div>
          <div class="bt-item">
            <div class="label">범위</div>
            <div class="value" id="bt-range">-</div>
          </div>
        </div>
      </section>
    </div>
  </div>

  <!-- RESULT MODAL -->
  <div class="modal" id="result-modal">
    <div class="modal-card">
      <div class="modal-head">
        <h3 id="modal-title">결과</h3>
        <button class="btn icon" onclick="closeModal()"><i class="fa-solid fa-xmark"></i></button>
      </div>
      <div class="modal-body" id="modal-body"></div>
      <div class="modal-foot">
        <button class="btn" onclick="closeModal()">닫기</button>
      </div>
    </div>
  </div>

  <!-- TradingView -->
  <script src="https://s3.tradingview.com/tv.js"></script>

  <!-- ✅ JS 로드 순서 절대 고정: core → api → features -->
  <script src="./app.core.js"></script>
  <script src="./app.api.js"></script>
  <script src="./app.features.js"></script>
</body>
</html>
